<head>
<%- include("../../views/partials/user/headerNew") %>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@10/dist/sweetalert2.min.css"/>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="/public/css/style.css.map">


<style>
  body {
    font-family: 'Roboto', sans-serif;
    background-color: #f4f4f9;
    margin: 0;
    padding: 0;
    overflow-x: hidden;
}

.product-container {
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    max-width: 100%;
    padding: 50px;
    
    color: rgb(7, 7, 7);
    margin-bottom: 20px;
    box-sizing: border-box; /* Ensure padding doesn't cause overflow */
}

.product-images img {
    max-width: 100%; /* Ensure the images do not overflow */
    height: auto;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    cursor: zoom-in;
    transition: transform 0.3s ease;
    background-color: #007bff;
}

.related-products {
    padding: 50px 20px;
    background-color: #00131c;
    box-sizing: border-box; /* Ensure padding doesn't cause overflow */
}

.related-products-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 40px;
    margin-left: auto;
    margin-right: auto;
    width: 100%;
    box-sizing: border-box;
}

/* Ensures the overall container width doesn't cause overflow */
.img {
    width: 100%;
    height: 400px;
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    overflow: hidden;
}


  .product-details {
    flex: 1; 
    padding-top: 50px;
  }

  .product-images {
    flex: 1; 
    display: flex;
    flex-direction: row-reverse;
    align-items: center;
    gap: 20px;
    padding: 20px;
  }

  

  .image-container {
    text-align: center;
    
  }

  .price {
    font-size: 1.5rem;
    color: white;
    font-weight: 700;
  }

  button {
    background-color: #007bff;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    font-size: 1rem;
    cursor: pointer;
    transition: background-color 0.3s ease;
    margin-top: 20px;
  }

  button:hover {
    background-color: #0056b3;
  }

  .img {
    position: relative;
    width: 100%;
    height: 400px;
    background-image: url('https://www.shutterstock.com/image-photo/group-successful-confident-business-people-260nw-2044374842.jpg');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
  }

  .breadcrumb-container {
    position: absolute;
    margin-left: 10px;
    margin-top: 350px;
    width: 100%;
    color: white;
    padding: 20px;
    background-color: transparent;
    border-radius: 10px;
  }


  .star-rating {
    font-size: 30px; /* Size of the stars */
    color: rgb(3, 3, 3); /* Black color for unselected stars */
    cursor: pointer; /* Change cursor to pointer */
}

.star {
    transition: color 0.2s ease; /* Smooth color transition */
}

/* .star.selected,
.star:hover {
    color: #ffcc00;
} */


.star:nth-child(-n+3) {
    color: #ffcc00; /* Yellow color for the first three stars */
}





.related-products {
    padding: 50px 20px;
    
    
  }

.related-products-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); /* Responsive grid */
    gap: 40px; /* Space between items */
  
    margin-left: 70px;
    margin-right: 70px;
    padding-left: 30px;
    
}

.product-item {
   /* White background for product items */
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    text-align: center;
    transition: transform 0.3s, box-shadow 0.3s; /* Smooth hover effect */
    display: flex; /* Enable flexbox */
    flex-direction: column; /* Align items in a column */
    align-items: center;
  }

.product-item:hover {
    transform: translateY(-5px); /* Lift effect */
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2); /* Deeper shadow on hover */
}

.product-image {
    width: 100%; /* Full width */
    height: auto; /* Maintain aspect ratio */
    border-bottom: 2px solid #d35400; /* Highlight with a border */
  }

.product-title {
    font-size: 1.2rem; /* Font size for title */
    margin: 10px 0; /* Margin for spacing */
    color: #333; /* Dark color for contrast */
}

.product-price {
    font-size: 1rem; /* Font size for price */
    color: #d35400; /* Use primary color for price */
    margin-bottom: 10px; /* Space below price */
}

.view-details-btn {
    background-color: #007bff; /* Button background color */
    color: white; /* Button text color */
    padding: 10px 15px; /* Padding for button */
    border-radius: 5px; /* Rounded corners */
    text-decoration: none; /* No underline */
    transition: background-color 0.3s; /* Smooth transition */
}

.view-details-btn:hover {
    background-color: #0056b3; /* Darker shade on hover */
}


.product-images {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 20px;
  width: 100%;
}

.large-image-container {
  flex: 3;
  text-align: center;
}

.large-image {
  max-width: 100%;
  height: auto;
  border-radius: 10px;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
  cursor: zoom-in;
  transition: transform 0.3s ease;
}

.thumbnail-images {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 10px;
  justify-content: flex-start;
  align-items: center;
}

.thumbnail {
  width: 70px;
  height: 70px;
  object-fit: cover;
  border-radius: 5px;
  cursor: pointer;
  transition: transform 0.3s ease, border 0.3s ease;
}

.thumbnail:hover {
  transform: scale(1.1);
}

.active-thumbnail {
  border: 2px solid #007bff;
  transform: scale(1.2);
}



</style>

</head>

<body>
  <div class="img" style="width: 100%;">
    <div class="breadcrumb-container">
      <a href="/" style="color:white">Home</a> / <a href="/shop" style="color: white;">Shop</a> /
      <% if (product) { %>
        <a href="/category/<%= product.category %>"><%= product.category.name %></a>  <%= product.productName %>
      <% } else { %>
        <span>Product not available</span>
      <% } %>
    </div>
  </div>

  <% if (product) { %>
    <div class="product-container" style="width: 100%;">
    
      <div class="product-images">
        <div class="large-image-container">
          <img id="largeImage" src="/uploads/product-imgs/<%= product.productImage[1] %>" alt="<%= product.productName %>" class="zoomable-image large-image">
        </div>
        <div class="thumbnail-images" style="margin-top: 70px;">
          <% product.productImage.forEach((image, index) => { %>
            <img src="/uploads/product-imgs/<%= image %>" alt="<%= product.productName %>" class="thumbnail <%= index === 0 ? 'active-thumbnail' : '' %>" data-image="/uploads/product-imgs/<%= image %>">
          <% }) %>
        </div>
      </div>
      
      

      <!-- Product Details -->
      <div class="product-details" style="margin-left: 100px; background-color: #e4dbd4 ; text-align: center;">
        <h4 style="color:#130f13 ; font-family:'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif; font-style: italic;"><%= product.productName %></h4>
        <br>
        <h4 style="font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;color:#98735c;;"> <%= product.description %></h4>
        <br>
  
        <% if (product.salePrice < product.regularPrice) { %>
          <p style="text-decoration: line-through; margin-bottom: 0.1px;  color: #000; font-family:'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;font-weight: 10px;"> Original Price &#8377; <%= product.regularPrice %> </p>
          <p style="color: rgb(12, 197, 12); margin-top: 1px; color: #000; font-family:'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;font-weight: 10px;">Offer Price &#8377; <%= product.salePrice %></p>
      <% } else { %>
          <p>&#8377; <%= product.regularPrice %></p>
      <% } %>
        <hp style="color: rgb(7, 7, 7);">inclusive of all taxes</p>
 
        
        
        <label >Select Size</label>
        <br>
        <select  id="sizeSelect" name="size" style="height: 30px; width: 100px; align-items: center;">
          <% product.stock.forEach(stockItem=>{ %>
            <%if(stockItem.quantity>0){ %>
           <option value="<%= stockItem.size %>"><%= stockItem.size %></option>
           <%}%>
            <%})%> 
          
        </select>
               
        <br>
        <% if (product.quantity > 0) { %>
        <button style="width: 170px;height: 40px; background-color: rgb(12, 136, 12); color: white;align-items: center; border-radius:15px;">
          <a  href="#" class="btn  add-to-cart" data-product-id="<%= product._id %>" style="color: #fff;margin-top: -9px;">
              ADD TO BAG 
          </a>
        </button>
      <% } else { %>
          <p class="out-of-stock" style="color: rgb(180, 17, 17);">Out of Stock</p>
      <% } %>
<br>
        <a href="" class="wishlist-btn" data-product-id="<%= product._id %>" ></a>
      <i class="fas fa-heart fa-lg" style="color: rgb(233, 38, 38); margin-top: 20px;" ></i>
  </a> 

        
        <p style="margin-top: 20px;">
          <% if (product.quantity > 0) { %>
            <span style="color: rgb(15, 15, 15);">Available</span>
          <% } else { %>
            <span style="color: rgb(233, 54, 63);">Sorry, This product is unavailable now</span>
          <% } %>
        </p>
        
      <div>

          
      </div>
      <div class="star-rating">
        <span class="star" data-value="1">&#9733;</span>
        <span class="star" data-value="2">&#9733;</span>
        <span class="star" data-value="3">&#9733;</span>
        <span class="star" data-value="4">&#9733;</span>
        <span class="star" data-value="5">&#9733;</span>
        
    </div>

            
              
      
    
  </div>
  
   </div>
   <div class="relatedprodect" style="width: 100%;"></div>
  <% } else { %>
    <p style="text-align: center;">This product is currently unavailable.</p>
  <% } %>

  

<div class="related-products" style="margin-bottom: 20px; background-color: white;">
  <h3 style="text-align: center; color: #080808; margin-bottom: 20px;">Related Products</h3>
  <div class="related-products-grid">
      <% relatedProducts.forEach(product => { %>
          <div class="product-item">
              <a href="/product/<%= product._id %>">
                  <img src="/uploads/product-imgs/<%= product.productImage[0] %>" alt="<%= product.productName %>" class="product-image">
              </a>
              <h4 class="product-title" style="color: #080808;;"><%= product.productName %></h4>
              <!-- <p class="product-price" style="color: black;">&#8377; <%= product.salePrice %></p> -->

              <% if (product.salePrice < product.regularPrice) { %>
                <p style="text-decoration: line-through; margin-bottom: 0.1px;">&#8377; <%= product.regularPrice %> </p>
                <p style="color: rgb(12, 197, 12); margin-top: 1px;">&#8377; <%= product.salePrice %></p>
            <% } else { %>
                <p>&#8377; <%= product.regularPrice %></p>
            <% } %>
              
          </div>
      <% }) %>
  </div>
</div>


   
  
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10/dist/sweetalert2.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  

  <%- include("../../views/partials/user/footer") %>
  

  
  <script>
    document.querySelectorAll('.zoomable-image').forEach(img => {
      let isZoomed = false;

      img.addEventListener('click', () => {
        if (!isZoomed) {
          img.style.transform = 'scale(2)';
          img.style.cursor = 'move';
          isZoomed = true;
          img.addEventListener('mousemove', panImage);
        } else {
          img.style.transform = 'scale(1)';
          img.style.cursor = 'zoom-in';
          isZoomed = false;
          img.removeEventListener('mousemove', panImage);
        }
      });

      function panImage(e) {
        if (isZoomed) {
          const rect = img.getBoundingClientRect();
          const x = e.clientX - rect.left;
          const y = e.clientY - rect.top;

          const moveX = ((x / rect.width) - 0.5) * 100;
          const moveY = ((y / rect.height) - 0.5) * 100;

          img.style.transform = `scale(2) translate(${moveX}%, ${moveY}%)`;
        }
      }
    });
 


    $(document).ready(function() {
        $(".add-to-cart").click(function(e) {
            e.preventDefault();
            const productId = $(this).data("product-id");
            
            const size = $("select[name='size']").val();

            $.ajax({
                url: '/cart/add',
                method: 'POST',
                data: { productId: productId,size: size},
                success: function(response) {
                    Swal.fire('Added!', response.message, 'success');
                },
                error: function(error) {
                  console.log("AJAX error:", error);
                    Swal.fire('Oops!', 'Something went wrong!', 'error');
                }
            });
        });
    });


    $(document).ready(function() {
    $(".wishlist-btn").click(function(e) {
        e.preventDefault();
        const productId = $(this).data("product-id");

        $.ajax({
            url: '/wishlist/add',
            method: 'POST',
            data: { productId: productId },
            success: function(response) {
                if (response.message === 'Product is already in your wishlist!') {
                    Swal.fire('Already Added!', response.message, 'info'); 
                } else {
                    Swal.fire('Added to Wishlist!', response.message, 'success'); 
                }
            },
            error: function(xhr, status, error) {
                console.error("Error details:", xhr.responseText);
                Swal.fire('Oops!', 'Something went wrong! ' + xhr.responseText, 'error'); 
            }
        });
    });
});


    document.addEventListener("DOMContentLoaded", function () {
    const largeImage = document.getElementById("largeImage");
    const thumbnails = document.querySelectorAll(".thumbnail");

    // Change the large image on thumbnail click
    thumbnails.forEach(thumbnail => {
      thumbnail.addEventListener("click", function () {
        const newImageSrc = this.getAttribute("data-image");
        largeImage.src = newImageSrc;

        
        thumbnails.forEach(thumb => thumb.classList.remove("active-thumbnail"));
        this.classList.add("active-thumbnail");
      });
    });
  
  
    let isZoomed = false;

    largeImage.addEventListener("click", () => {
      if (!isZoomed) {
        largeImage.style.transform = "scale(2)";
        largeImage.style.cursor = "move";
        isZoomed = true;
        largeImage.addEventListener("mousemove", panImage);
      } else {
        largeImage.style.transform = "scale(1)";
        largeImage.style.cursor = "zoom-in";
        isZoomed = false;
        largeImage.removeEventListener("mousemove", panImage);
      }
    });

    function panImage(e) {
      if (isZoomed) {
        const rect = largeImage.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;

        const moveX = ((x / rect.width) - 0.5) * 100;
        const moveY = ((y / rect.height) - 0.5) * 100;

        largeImage.style.transform = `scale(2) translate(${moveX}%, ${moveY}%)`;
      }
    }
  });



  
</script>

